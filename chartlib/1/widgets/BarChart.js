/* Copyright (c) Ericsson 2016 */

define("chartlib/widgets/barchart/ext/BarChartExt",["chartlib/base/d3","chartlib/main"],function(t,e){"use strict";return e.extend({init:function(e){this.attach(e.parent);var n=this.getD3Element();this.settings={w:500,h:150,color:"category20c",data:[]},this.settings=this.mergeProperties(this.settings,e.settings),this.color=this.getColorsPalette(this.settings.color),this.x=t.scale.ordinal().domain(t.range(this.settings.data.length)).rangeRoundBands([0,this.settings.w],.1),this.y=t.scale.linear().rangeRound([this.settings.h,0]);var r=n.append("svg:svg").attr("width",this.settings.w).attr("height",this.settings.h),a=r.append("g").attr("transform","translate(0, 0)"),i=a.selectAll(".state").data(this.settings.data).enter().append("g").attr("class","state").attr("width",this.x.rangeBand()).attr("transform",function(t,e){return"translate("+this.x(e)+",0)"}.bind(this));i.selectAll("rect").data(function(t){return t.bars}).enter().append("rect").attr("width",this.x.rangeBand()).attr("y",function(t){return this.y(t.y1)}.bind(this)).attr("height",function(t){return this.y(t.y0)-this.y(t.y1)}.bind(this)).style("fill",function(t){return t.color}).append("svg:title").text(function(t){return t.value})},updateX:function(e){this.x=t.scale.ordinal().domain(t.range(e)).rangeRoundBands([0,this.settings.w],.1)},update:function(t){var e=this.getD3Element(),n=e.select("svg");n.select("g").remove();var r=n.append("g").attr("transform","translate(0, 0)"),a=r.selectAll(".state").data(t).enter().append("g").attr("class","state").attr("width",this.x.rangeBand()).attr("transform",function(t,e){return"translate("+this.x(e)+",0)"}.bind(this));a.selectAll("rect").data(function(t){return t.bars}).enter().append("rect").attr("width",this.x.rangeBand()).attr("y",function(t){return this.y(t.y1)}.bind(this)).attr("height",function(t){return this.y(t.y0)-this.y(t.y1)}.bind(this)).style("fill",function(t){return t.color}).append("svg:title").text(function(t){return t.value})},getBarHeight:function(){return this.settings.h},getBarWidth:function(){return this.settings.w},getColoredBars:function(t,e){var n=0,r=this.color.range().map(function(r,a){return{color:r,y0:n,y1:n+=+e[a],value:t[a]}});return r.forEach(function(t){t.y0/=n,t.y1/=n}),r}})}),define("chartlib/widgets/barchart/BarChart",["jscore/core","./ext/BarChartExt"],function(t,e){"use strict";return t.Widget.extend({init:function(t){this.options=t||{}},onViewReady:function(){this.barChart=new e({parent:this.getElement(),settings:this.options.settings}),this.options.data&&(this.updateBarX(this.options.data.length),this.update(this.options.data))},updateBarX:function(t){this.barChart.updateX(t)},update:function(t){this.barChart.update(t)},getChartHeight:function(){return this.barChart.getBarHeight()},getChartWidth:function(){return this.barChart.getBarWidth()},getColoredBars:function(t,e){return this.barChart.getColoredBars(t,e)}})}),define("chartlib/widgets/BarChart",["chartlib/widgets/barchart/BarChart"],function(t){return t});